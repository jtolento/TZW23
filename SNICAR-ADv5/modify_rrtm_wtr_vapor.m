clc;clear all; close all;clc;
%% WATER PROFILES %%%

 inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
 outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd00';
 inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
 outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc00';
 scalar = 0.0;
 modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
 modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

 inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
 outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd1';
 inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
 outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc1';
 scalar = 0.1;
 modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
 modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)
 
inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd2';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc2';
scalar = 0.2;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd3';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc3';
scalar = 0.3;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd4';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc4';
scalar = 0.4;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd5';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc5';
scalar = 0.5;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd6';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc6';
scalar = 0.6;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd7';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc7';
scalar = 0.7;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd8';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc8';
scalar = 0.8;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd9';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc9';
scalar = 0.9;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd10';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_spc10';
scalar = 1.0;
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)


 %% SNOW PROFILES %%%
inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd00';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc00';
scalar = 0.0;
disp('Humidity 0%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd1';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc1';
scalar = 0.1;
disp('Humidity 10%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd2';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc2';
scalar = 0.2;
disp('Humidity 20%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd3';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc3';
scalar = 0.3;
disp('Humidity 30%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd4';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc4';
scalar = 0.4;
disp('Humidity 40%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd5';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc5';
scalar = 0.5;
disp('Humidity 50%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd6';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc6';
scalar = 0.6;
disp('Humidity 60%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

 inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
 outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd7';
 inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
 outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc7';
 scalar = 0.7;
 disp('Humidity 70%')
 modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
 modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd8';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc8';
scalar = 0.8;
disp('Humidity 80%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd9';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc9';
scalar = 0.9;
disp('Humidity 90%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

 inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd';
 outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_brd10';
 inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc';
 outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/snw_wvc/input_mls_spc10';
 scalar = 1.0;
 disp('Humidity 100%')
 modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
 modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)



%% ICE PROFILES %%% 


 inputFilePath_brd  = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
 outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd00';
 inputFilePath_spc  = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
 outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc00';
 scalar = 0.0;
 modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
 modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)
 
inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd1';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc1';
scalar = 0.1;
disp('Humidity 10%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd2';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc2';
scalar = 0.2;
disp('Humidity 20%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd3';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc3';
scalar = 0.3;
disp('Humidity 30%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd4';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc4';
scalar = 0.4;
disp('Humidity 40%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd5';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc5';
scalar = 0.5;
disp('Humidity 50%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd6';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc6';
scalar = 0.6;
disp('Humidity 60%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

 inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
 outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd7';
 inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
 outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc7';
 scalar = 0.7;
 disp('Humidity 70%')
 modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
 modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd8';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc8';
scalar = 0.8;
disp('Humidity 80%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd9';
inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc9';
scalar = 0.9;
disp('Humidity 90%')
modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)

 inputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd';
 outputFilePath_brd = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_brd10';
 inputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc';
 outputFilePath_spc = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/ice_wvc/input_sas_spc10';
 scalar = 1.0;
 disp('Humidity 100%')
 modify_rrtm_wtr_vpr(inputFilePath_brd, outputFilePath_brd,scalar)
 modify_rrtm_wtr_vpr(inputFilePath_spc, outputFilePath_spc,scalar)





function modify_rrtm_wtr_vpr(inputFilePath, outputFilePath,scalar)
% File paths
%inputFilePath = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brd';
%outputFilePath = '/Users/jtolento/TZW23/RRTMG_SW/run_examples_std_atm/ppr1/sps/wtr_wvc/input_trp_brdtest';
%scalar = 1.0;
% Read the input file
fidIn = fopen(inputFilePath, 'r');
fidOut = fopen(outputFilePath, 'w');

if fidIn == -1
    error('Could not open the input file.');
end

if fidOut == -1
    error('Could not create the output file.');
end

% Read and save the first 10 lines
headerLines = cell(9, 1);
for i = 1:9
    headerLines{i} = fgetl(fidIn);
end

modifiedLines = {};
a = 0;
eps_H2O = 0.622;
one_mns_eps_H2O = 1 - eps_H2O;
% Read, modify, and write the remaining lines
while ~feof(fidIn)
    %a = a+1;
    %disp(a)
    %disp(fidIn)
    %disp(fgetl(fidIn))
    line = fgetl(fidIn);
    
    
    %disp()
    if ischar(line)
        % Check if the line contains ' 3 '
        if contains(line,' 1 ')
            % Write the original line (no modification needed)
            modifiedLines{end+1} = line;
            parts = strsplit(line);
            tpt = str2double(parts{3});
            P = str2double(parts{2});
            prs = P;%*1000;
            %disp(P)
            %disp(tpt)
        elseif contains(line,' 3 ')
            % Write the original line (no modification needed)
            modifiedLines{end+1} = line;
            parts = strsplit(line);
            tpt = str2double(parts{3});
            P = str2double(parts{2});
            prs = P;%*1000;
            %disp(P)
            %disp(tpt)
        else
            % Split the line by spaces
            parts = strsplit(line);
            %disp(parts)
            % Convert the first column value to a number
            x = str2double(parts{2});
            %disp(x)
            
            if ~isnan(x)
                %disp('true')
                % Multiply x by the scalar b
                %y = x * scalar;
                if or((tpt>273.15),(tpt<223.15))
                    %sat_vpr_lqd = 100.0 * exp(21.6 - 5420.0 / tpt);  % [Pa] Salby
                    %sat_vpr_lqd = sat_vpr_lqd /100; %[hPa]
                    % PrK78
                    %svp_H2O_lqd_PrK78(tpt)
                    sat_vpr_lqd = svp_H2O_lqd_PrK78(tpt);
                    sat_vpr_lqd = sat_vpr_lqd /100;
                else
                    sat_vpr_lqd = svp_H2O_ice_PrK78(tpt);
                    sat_vpr_lqd = sat_vpr_lqd /100;
                end
                if (prs < one_mns_eps_H2O*sat_vpr_lqd)
                    disp('warning')
                    q = 0.0;
                else
                    %q = eps_H2O*sat_vpr_lqd/(prs-one_mns_eps_H2O*sat_vpr_lqd);
                    svp = sat_vpr_lqd;

                    R = 8.314; % J / (mol * K)
                    avo_nbr = 6.02*10^23; % avogadros number
                    mm_air = 28.97;  %molar mass air 
                    mm_h2o = 18.015; %molar mass water 
                    n_h2o = (svp*100) / (R*tpt) * mm_h2o;    % g/m^3
                    n_air = (prs*100) / (R*tpt) * mm_air; %  g/m^3
    
                    molec_h2o = n_h2o * avo_nbr / mm_h2o;
                    molec_air = n_air * avo_nbr / mm_air;
                    mmr_h2o = n_h2o / n_air;           
                    vmr_h2o = molec_h2o / molec_air ; 
                    disp('pressure')
                    %disp(prs)
                    %disp(svp)
                    %disp(mmr_h2o)
                    %disp(vmr_h2o)
                    q = vmr_h2o;
                end
               
                
                if (q < 0.0)
                    disp('negative:')
                    disp(tpt)
                    disp(prs)
                    disp(q)
                    q = 0.0;
                end
                
                
                if (prs <= 1.5)
                    q = 0.0;
                end
                y = q*scalar;
                % Format x and y in exponential notation
                xFormatted = sprintf('%0.7E', x);
                yFormatted = sprintf('%0.7E', y);
                %disp(xFormatted)
                %disp(yFormatted)
                
                % Replace x with y in the line
                modifiedLine = strrep(line, xFormatted, yFormatted);
                %disp(modifiedLine)
                modifiedLines{end+1} = modifiedLine;
                %disp('CHECK')
                %disp(line)
                % Write the modified line to the output file
                
            else
                % Write the original line (no modification needed)
                modifiedLines{end+1} = line;
            end
        end
    end
end

% Close the files
fclose(fidIn);

% Write the header lines to the output file
for i = 1:9
    fprintf(fidOut, '%s\n', headerLines{i});
end

% Write the modified lines to the output file
for i = 1:numel(modifiedLines)
    fprintf(fidOut, '%s\n', modifiedLines{i});
    %disp(modifiedLines{i})
end

str_end1 = '%%%%%';
str_end2 = '123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-';

fprintf(fidOut,'%s\n%s\n',str_end1,str_end2);

fclose(fidOut);

disp('Modification completed.');
end


function svp_H2O = svp_H2O_ice_PrK78(tpt)
% Saturation vapor pressure over planar ice water, PrK78
% Compute saturation vapor pressure over planar ice water
% Input temperature in degrees kelvin
% Saturation vapor pressure returned in [Pa]
% Taken from Lowe and Ficke (1974) as reported in PrK78 p. 625
% Range of validity is -50 C < T < 0 C

% Fundamental and derived physical constants
tpt_frz_pnt = 273.15; % Freezing point in Kelvin

% Constants
cff = [6.109177956, 5.034698970e-1, 1.886013408e-2, 4.176223716e-4, ...
    5.824720280e-6, 4.838803174e-8, 1.838826904e-10];

% Main code
tpt_cls = tpt - tpt_frz_pnt; % [C]
svp_H2O_ice_dbl = cff(1) + tpt_cls * (cff(2) + tpt_cls * (cff(3) + ...
    tpt_cls * (cff(4) + tpt_cls * (cff(5) + tpt_cls * (cff(6) + ...
    cff(7) * tpt_cls)))));

svp_H2O_ice_PrK78 = svp_H2O_ice_dbl * 100.0; % [mb] --> [Pa]
svp_H2O = svp_H2O_ice_PrK78;
return
end

function svp_H2O = svp_H2O_lqd_PrK78(tpt)
%Saturation vapor pressure over planar liquid water, PrK78
%Compute saturation vapor pressure over planar liquid water
%Input temperature in degrees kelvin
%aturation vapor pressure returned in [Pa]
%Taken from PrK78 p. 625
%Range of validity is -50 C < T < 50 C

%Fundamental and derived physical constants
tpt_frz_pnt = 273.15; % Freezing point in Kelvin

%Constants
cff = [6.107799961, 4.436518521e-1, 1.428945805e-2, 2.650648471e-4, ...
    3.031240396e-6, 2.034080948e-8, 6.136820929e-11];

%Main code
tpt_cls = tpt - tpt_frz_pnt; % [C]
if tpt_cls > -50.0
    svp_H2O_lqd_dbl = cff(1) + tpt_cls * (cff(2) + tpt_cls * (cff(3) + ...
        tpt_cls * (cff(4) + tpt_cls * (cff(5) + tpt_cls * (cff(6) + ...
        cff(7) * tpt_cls)))));
    svp_H2O_lqd_PrK78 = svp_H2O_lqd_dbl * 100.0; % [mb] --> [Pa]
else
    svp_H2O_lqd_PrK78 = svp_H2O_lqd_Bol80(tpt);
end
svp_H2O = svp_H2O_lqd_PrK78;
return
end

function svp_H2O = svp_H2O_lqd_Bol80(tpt)
% Saturation vapor pressure over planar liquid water, Bol80
% Compute saturation vapor pressure over planar liquid water
% Input temperature in degrees kelvin
% Saturation vapor pressure returned in [Pa]
% Taken from Bol80
% This Bol80 parameterization has an accuracy of 0.1% for -30 < tpt_cls < 35 C

% Fundamental and derived physical constants
tpt_frz_pnt = 273.15; % Freezing point in Kelvin

% Main code
tpt_cls = tpt - tpt_frz_pnt; % [C]
svp_H2O_lqd_dbl = 6.112 * exp(17.67 * tpt_cls / (tpt_cls + 243.5)); % [mb] Bol80
svp_H2O_lqd_Bol80 = svp_H2O_lqd_dbl * 100.0; % [mb] --> [Pa]
svp_H2O = svp_H2O_lqd_Bol80;
return
end

